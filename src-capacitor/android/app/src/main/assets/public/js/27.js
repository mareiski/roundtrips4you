(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{"3ba0":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-timeline-entry",{ref:t.lastItem?"lastTimelineEntry":null,attrs:{icon:"location_on"},scopedSlots:t._u([{key:"subtitle",fn:function(){return[i("span",{staticClass:"q-timeline__title"},[t._v("\n      "+t._s(null!==t.date&&"undefined"!==typeof t.date&&t.date.length>0?t.date.split(" ")[0]:t.date)+"\n      ")]),i("span",{staticClass:"q-timeline__title",staticStyle:{"padding-right":"10px"}},[t._v("\n      "+t._s(null!==t.date&&t.date.length>0?t.date.split(" ")[1]:t.date)+"\n      ")])]},proxy:!0}])},[i("div",{staticClass:"stop-container"},[i("h6",{staticClass:"q-timeline__title",staticStyle:{"margin-bottom":"0"}},[t._v(t._s(t.titleInput))]),i("div",{staticClass:"flex q-timeline__subtitle",staticStyle:{"padding-top":"0"}},[i("a",{on:{click:function(e){t.editor?t.editLocation=!0:t.openInNewTab("https://www.google.com/maps/search/?api=1&query="+t.location.label)}}},[i("q-icon",{attrs:{name:"location_on"}}),t._v("\n        "+t._s(t.location&&"undefined"!==typeof t.location&&t.location.label&&"undefined"!==typeof t.location.label?t.location.label.split(",")[0]:t.editor?"Ort hinzufügen":"kein Ort angegeben")+"\n        "),t.location&&t.location.label?i("q-tooltip",[t._v(t._s(t.location.label))]):t._e()],1)]),i("Uploader",{attrs:{RTId:t.RTId,stopImages:t.stopImages?t.stopImages:null,uploadDisabled:!0}}),t.addedSights&&t.addedSights.length>0?i("div",{staticClass:"flex",staticStyle:{"margin-bottom":"10px"}},[i("b",{staticClass:"flex justify-center",staticStyle:{"flex-direction":"column"}},[t._v("gemerkte Orte:")]),t._l(t.addedSights,(function(e,a){return i("q-chip",{key:a,attrs:{clickable:""},on:{click:function(i){return t.$refs.sightDialog.openSightDialog(e)}}},[t._v(t._s(e))])}))],2):t._e()],1),i("SightDialog",{ref:"sightDialog",attrs:{addAble:!1}}),i("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[i("q-expansion-item",{class:"stop-expansion-item "+(null!==t.days||t.firstStop||t.lastItem||"plane"===t.stopObject.Profile?"":"error-color"),attrs:{"expand-separator":"",label:(t.stopObject.HotelName?"1 Hotel":"Weitere Infos")+(t.dailyTrips.length?" & "+t.dailyTrips.length+(1===t.dailyTrips.length?" Tagesausflug":" Tagesausflüge"):""),caption:null!==t.days?"ca. "+t.days+" Aufenthalt":t.firstStop||t.lastItem||"plane"===t.stopObject.Profile?"":"keine Verbleibende Zeit für den Aufenthalt"},on:{input:function(e){return t.$emit("expansionChanged",{expanded:t.expanded,docId:t.stopObject.DocId})}},model:{value:t.expanded,callback:function(e){t.expanded=e},expression:"expanded"}},[i("div",[t.editor?i("q-chip",{attrs:{icon:"local_parking",clickable:t.editor},on:{click:function(e){t.editParkingPlace=!0}}},[t._v(t._s(t.parkingPlace&&"undefined"!==typeof t.parkingPlace&&t.parkingPlace.label&&"undefined"!==typeof t.parkingPlace.label?t.parkingPlace.label.split(",")[0]:"Parkplatz hinzufügen")+"\n          ")]):t._e()],1),i("div",[i("div",[t.stopObject.HotelName?i("q-list",{staticClass:"rounded-borders",attrs:{bordered:"",padding:"",dense:""}},[i("q-item",{staticClass:"hotel-list"},[i("q-item-section",{attrs:{avatar:"",top:""}},[i("q-avatar",{attrs:{color:"secondary","text-color":"white","font-size":"20px",icon:"hotel"}})],1),i("q-item-section",[i("q-item-label",{staticClass:"flex",staticStyle:{"flex-wrap":"wrap","white-space":"normal"},attrs:{lines:"2"}},[i("span",{staticStyle:{"padding-right":"5px"}},[t._v(t._s(t.sharedMethods.capitalize(t.stopObject.HotelName)))]),t.hotelStars&&!isNaN(t.hotelStars)?i("q-rating",{staticClass:"stars",staticStyle:{"margin-right":"10px","padding-right":"5px"},attrs:{readonly:"",size:"15px",color:"gold"},model:{value:t.hotelStars,callback:function(e){t.hotelStars=e},expression:"hotelStars"}}):t._e(),i("div",{staticClass:"flex",staticStyle:{"flex-wrap":"wrap","white-space":"normal"}},[t.stopObject.GuestRating?i("span",{staticClass:"raleway"},[t._v("\n                      "+t._s(t.stopObject.GuestRating)+", \n                    ")]):t._e(),t.stopObject.HotelPrice?i("span",[i("span",{staticClass:"raleway"},[t._v("ca. € ")]),i("span",{staticClass:"raleway"},[t._v(t._s(t.stopObject.HotelPrice))]),i("q-tooltip",[t._v("ungefährer Durchschnittspreis pro Person & Nacht")])],1):t._e()])],1),i("q-item-label",{staticStyle:{overflow:"hidden"},attrs:{caption:""}},[i("a",{staticClass:"ellipsis",on:{click:function(e){t.openInNewTab("https://www.google.com/maps/search/?api=1&query="+t.capitalize(t.stopObject.HotelName+", "+t.stopObject.HotelLocation.label))}}},[t._v(t._s(t.stopObject.HotelLocation&&"undefined"!==typeof t.stopObject.HotelLocation&&t.stopObject.HotelLocation.label&&"undefined"!==typeof t.stopObject.HotelLocation.label?t.capitalize(t.stopObject.HotelLocation.label):"kein Ort angegeben"))])])],1),i("q-item-section",[t.stopObject.TransportLocations&&t.stopObject.TransportLocations.length>0?i("q-btn",{staticStyle:{width:"150px"},on:{click:function(e){t.showTransportDialog=!0}}},[t._v("Transport\n                ")]):t._e()],1),i("q-dialog",{model:{value:t.showTransportDialog,callback:function(e){t.showTransportDialog=e},expression:"showTransportDialog"}},[i("q-card",[i("q-card-section",{staticClass:"row items-center flex",staticStyle:{"flex-direction":"column"}},[i("q-list",t._l(t.stopObject.TransportLocations,(function(e){return i("div",{key:e,staticClass:"flex",staticStyle:{"flex-direction":"column"}},t._l(e.locations,(function(a){return i("q-item",{key:a,attrs:{clickable:""},on:{click:function(e){return t.openInNewTab("https://www.google.com/maps/search/?api=1&query="+a.name)}}},[i("q-item-section",[i("span",[i("q-icon",{attrs:{name:t.getHotelTransportationIcon(e.category)}}),i("span",[t._v(t._s(a.name))])],1),i("p",[t._v(t._s(a.distanceInTime))])])],1)})),1)})),0)],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK",color:"primary"}})],1)],1)],1),i("q-item-section",{attrs:{side:""}},[t.stopObject.GeneralTempLink&&t.stopObject.GeneralTempLink.length>0?i("div",[i("q-chip",{staticClass:"linkChip",attrs:{icon:"link",dense:"",clickable:""},on:{click:function(e){return t.openInNewTab(t.stopObject.GeneralTempLink)}}},[t._v("Hotelwebsite")])],1):t._e(),t.stopObject.HotelName?i("q-chip",{staticClass:"linkChip",staticStyle:{width:"117px"},attrs:{icon:"launch",dense:"",clickable:""},on:{click:function(e){t.openInNewTab("https://www.booking.com/searchresults.de.html?ss="+t.capitalize(t.stopObject.HotelName)+"&checkin_year="+t.date.split(" ")[0].split(".")[2]+"&checkin_month="+t.date.split(".")[1]+"&checkin_monthday="+t.date.split(".")[0]+"&checkout_year="+t.checkOutDate.split(".")[2]+"&checkout_month="+t.checkOutDate.split(".")[1]+"&checkout_monthday="+t.checkOutDate.split(".")[0]+"&group_adults="+t.adults+t.getChildrenText()+"&no_rooms="+t.rooms+"&ac_langcode=de")}}},[t._v(" booking.com\n                  "),i("q-tooltip",[t._v("Hotel auf booking.com")])],1):t._e(),t.stopObject.HotelName?i("q-chip",{staticClass:"linkChip",staticStyle:{width:"117px"},attrs:{icon:"launch",dense:"",clickable:""},on:{click:function(e){t.openInNewTab("https://www.expedia.de/Hotel-Search?adults="+t.adults+"children="+t.getExpediaChildrenText()+"%2C1_3&destination="+t.capitalize(t.stopObject.HotelName)+"&endDate="+t.checkOutDate.split(" ")[0].split(".")[2]+"-"+t.checkOutDate.split(".")[1]+"-"+t.checkOutDate.split(".")[0]+"&rooms="+t.rooms+"&sort=RECOMMENDED&startDate="+t.date.split(" ")[0].split(".")[2]+"-"+t.date.split(".")[1]+"-"+t.date.split(".")[0]+"&theme=&useRewards=true")}}},[t._v(" expedia\n                  "),i("q-tooltip",[t._v("Hotel auf expedia")])],1):t._e()],1),t.stopObject.HotelContact?i("q-item-section",{attrs:{side:""}},[i("div",{staticClass:"hotel-contact"},[t.stopObject.HotelContact.email?i("q-chip",{attrs:{icon:"email",clickable:""},on:{click:function(e){return t.openInNewTab("mailto:"+t.stopObject.HotelContact.email)}}},[t._v(t._s(t.stopObject.HotelContact.email)+"\n                  ")]):t._e(),t.stopObject.HotelContact.phone?i("q-chip",{attrs:{icon:"phone",clickable:""},on:{click:function(e){return t.openInNewTab("tel:"+t.stopObject.HotelContact.phone)}}},[t._v(t._s(t.stopObject.HotelContact.phone)+"\n                  ")]):t._e()],1)]):t._e()],1)],1):t._e()],1),t.editor?t._e():i("div",{staticStyle:{"margin-top":"10px","margin-bottom":"20px"},domProps:{innerHTML:t._s(t.descriptionInput)}}),t.expanded?i("div",{directives:[{name:"show",rawName:"v-show",value:t.dailyTrips.length,expression:"dailyTrips.length"}],staticClass:"daily-trip-container"},t._l(t.dailyTrips,(function(e,a){return i("DailyTrip",{key:e.id+a,staticStyle:{"margin-top":"10px"},attrs:{dailyTrip:e,editorToolbar:t.editorToolbar,editorFonts:t.editorFonts,stopDocId:t.stopObject.DocId,index:a,newDailyTripDate:!!e.newDate&&e.newDate,duration:e.duration,editor:t.editor,addedSights:e.addedSights,galeryImgUrls:t.galeryImgUrls,dateOptions:t.dailyTripDateOptions}})})),1):t._e()]),i("q-dialog",{model:{value:t.addDailyTripDialogVisible,callback:function(e){t.addDailyTripDialogVisible=e},expression:"addDailyTripDialogVisible"}},[i("q-card",{staticStyle:{width:"100%","max-width":"100vh",overflow:"hidden"}},[i("q-card-section",{staticClass:"daily-trip-dialog-section"},[i("q-input",{staticClass:"input-item",staticStyle:{width:"300px"},attrs:{filled:"","error-message":"Bitte gib ein richtiges Datum an",error:!t.sharedMethods.isDateTimeValid(),"lazy-rules":"","bottom-slots":"",outlined:""},scopedSlots:t._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"event"}},[i("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{attrs:{"today-btn":"",mask:"DD.MM.YYYY HH:mm",options:t.dailyTripDateOptions},model:{value:t.tempDailyTripDate,callback:function(e){t.tempDailyTripDate=e},expression:"tempDailyTripDate"}})],1)],1),i("q-tooltip",[t._v("Datum ändern")])]},proxy:!0},{key:"append",fn:function(){return[i("q-icon",{attrs:{name:"access_time"}},[i("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-time",{attrs:{mask:"DD.MM.YYYY HH:mm",format24h:""},model:{value:t.tempDailyTripDate,callback:function(e){t.tempDailyTripDate=e},expression:"tempDailyTripDate"}})],1)],1)]},proxy:!0}]),model:{value:t.tempDailyTripDate,callback:function(e){t.tempDailyTripDate=e},expression:"tempDailyTripDate"}}),i("CitySearch",{ref:"citySearch",attrs:{parkingPlaceSearch:!1},on:{update:function(e){return t.updateDailyTripLocation(e)}}}),i("q-select",{staticClass:"input-item",attrs:{outlined:"",options:["zu Fuß","Fahrrad","Auto"],label:"Reisemittel","use-input":"",rules:[function(t){return null!==t&&""!==t||"Bitte wähle ein Reisemittel"}]},scopedSlots:t._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"commute"}})]},proxy:!0}]),model:{value:t.dailyTripProfile,callback:function(e){t.dailyTripProfile=e},expression:"dailyTripProfile"}})],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Abbrechen",color:"primary"}}),i("q-btn",{attrs:{flat:"",label:"Hizufügen",color:"primary"},on:{click:function(e){return t.addDailyTrip()}}})],1)],1)],1)],1)],1)],1)},o=[],s=i("1261"),l=i("bd4c"),n=i("0831"),r=i("bc3a"),c=i.n(r),p=i("15c8");const{setScrollPosition:d}=n["a"];let h=Date.now(),u=null;var g={name:"stop",components:{CitySearch:()=>Promise.all([i.e(0),i.e(5)]).then(i.bind(null,"c097")),DailyTrip:()=>i.e(24).then(i.bind(null,"a070")),Uploader:()=>Promise.all([i.e(0),i.e(3)]).then(i.bind(null,"8c8d")),SightDialog:()=>i.e(25).then(i.bind(null,"c5df"))},computed:{sharedMethods(){return p["a"]}},props:{RTId:String,stopObject:Object,date:String,editor:Boolean,location:Object,days:String,parkingPlace:Object,lastItem:Boolean,hotelStars:Number,checkOutDate:String,adults:Number,childrenAges:Array,rooms:Number,firstStop:Boolean,galeryImgUrls:Array,stopImages:Array,addedSights:Array,dailyTrips:Array,nextStopDate:String,profile:String},watch:{date:function(t,e){this.tempDailyTripDate=this.date}},data(){return{titleInput:this.stopObject.Title,descriptionInput:this.stopObject.Description,showDateEntry:!0,showTimeEntry:!1,preventPasting:!1,editParkingPlace:!1,tempParkingPlace:{},editLocation:!1,tempLocation:{},savedEditorContent:this.stopObject.Description,sights:null,chooseImgDialog:!1,tempImgLink:null,dialogImgSrc:null,imgDialogVisible:!1,oldAddedSights:[],addHotel:!1,generalTempLink:"",formattedDate:l["b"].formatDate(h,"DD.MM.YYYY"),addDailyTripDialogVisible:!1,tempDailyTripLocation:null,tempDailyTripDate:this.date,dailyTripProfile:"Auto",expanded:!1,changeAllDatesActive:!1,oldDate:null,showTransportDialog:!1,addHotelDisabled:!0,editorFonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"},editorToolbar:[[{label:"",icon:this.$q.iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],["fullscreen"],[{label:"Größe",icon:this.$q.iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:"Schrift",icon:this.$q.iconSet.editor.font,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]}],["quote","unordered","ordered","outdent","indent"],["format","image"],["undo","redo"]]}},methods:{isDateTimeValid(){return p["a"].isDateTimeValid(this.tempDailyTripDate)},saveDate(t){const e=document.documentElement.scrollTop;let i=p["a"].getDateFromString(this.date);t&&(this.changeAllDatesActive?this.changeAllDates():this.oldDate=this.date);let a=this;s["b"].collection("RoundtripDetails").doc(this.stopObject.DocId).update({InitDate:i}).then((function(){t&&!a.changeAllDatesActive&&a.getParent("EditRoundtrips").resortAndPrepareStops(i,a.stopObject.DocId),setTimeout((function(){p["a"].scrollToOffset(e)}),500)}))},getDailyTripDuration(t,e,i,a,o,s,l){var n="https://api.mapbox.com/directions/v5/mapbox/"+i+"/"+t[0]+","+t[1]+";"+e[0]+","+e[1]+"?geometries=geojson&access_token="+this.$store.getters["api/getMapboxKey"];c.a.get(n).then(t=>{var e=t.data.routes[0];if(null!==e&&"undefined"!==typeof e){let t=p["a"].msToTime(1e3*e.duration),i=Math.floor(e.distance/1e3)>0?Math.floor(e.distance/1e3)+" km":"";""!==i&&(i=" ("+i+")"),this.dailyTrips[a].duration={duration:t,distance:i,cityFromLabel:o,defaultCityLabel:s},this.dailyTrips[a+1]&&!this.dailyTrips[a+1].newDate?this.getDailyTripDays(l,a,e.duration):(a===this.dailyTrips.length-1||a===this.dailyTrips.length-1)&&this.dailyTrips.sort(this.compare)}else this.dailyTrips[a].duration={duration:null,distance:null,cityFromLabel:null,defaultCityLabel:null},this.dailyTrips[a+1]&&this.getDailyTripDays(l,a,null)}).catch(t=>{console.log(t),this.dailyTrips[a].duration={duration:null,distance:null,cityFromLabel:null,defaultCityLabel:null}})},getDailyTripDays(t,e,i){let a=null,o=t.date.split(" "),s=o[0].split("."),l=o[1].split(":"),n=new Date(s[2],s[1]-1,s[0],l[0],l[1],"00");o=this.dailyTrips[e+1].date.split(" "),s=o[0].split("."),l=o[1].split(":");let r=new Date(s[2],s[1]-1,s[0],l[0],l[1],"00"),c=0;c=i?r.valueOf()-n.valueOf()-i:r.valueOf()-n.valueOf(),a=p["a"].msToTime(c),this.dailyTrips[this.dailyTrips.findIndex(e=>e.id===t.id)].days={days:a,id:t.id}},validURL(t){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return!!e.test(t)},getChildrenText(){let t="&group_children="+this.childrenAges.length;return this.childrenAges.forEach(e=>{t+="&age="+e}),t},getExpediaChildrenText(){let t=null;return this.childrenAges.forEach((e,i)=>{t+=(0!==i?"_":"")+e}),t},updateHotelData(t){if(null!==t){this.addHotelDisabled=!0;let e=t.latitude,i=t.longitude;this.stopObject.HotelName=t.name,t.destinationId?c.a.get("https://hotels4.p.rapidapi.com/properties/get-details?locale=de_DE&currency=EUR&id="+t.destinationId,{headers:{"content-type":"application/octet-stream","x-rapidapi-host":"hotels4.p.rapidapi.com","x-rapidapi-key":this.$store.getters["api/getHotels4Key"],useQueryString:!0}}).then(t=>{console.log(t);let a=t.data.data.body,o=a.propertyDescription,s=o.address.fullAddress,l=o.featuredPrice.currentPrice.plain,n=a.guestReviews.brands.formattedRating+" "+a.guestReviews.brands.badgeText,r=t.data.transportation.transportLocations;this.writeHotelData(s,e,i,o.starRating,l,n,r)}).catch(t=>{console.log(t)}):this.writeHotelData(t.label,e,i,null,null,null,null)}},writeHotelData(t,e,i,a,o,s,l){this.stopObject.HotelLocation={lng:e,lat:i,label:t},this.stopObject.HotelPrice=o&&"undefined"!==typeof o?o:null,this.stopObject.GuestRating=s&&"undefined"!==typeof s?s:null,this.stopObject.TransportLocations="undefined"!==typeof l?l:null,this.hotelStars=a&&"undefined"!==typeof a?a:null,this.addHotelDisabled=!1},getHotelTransportationIcon(t){switch(t){case"airport":return"flight";case"train-station":return"train";case"metro":return"subway";default:return"cummute"}},changeExpansion(t){this.expanded=t},addHotelToStop(){console.log(this.stopObject.TransportLocations),s["b"].collection("RoundtripDetails").doc(this.stopObject.DocId).update({HotelLocation:this.stopObject.HotelLocation,HotelStars:this.hotelStars,HotelContact:this.stopObject.HotelContact,HotelName:this.stopObject.HotelName,GeneralLink:this.stopObject.GeneralTempLink,CheckOutDate:this.checkOutDate,HotelPrice:this.stopObject.HotelPrice,GuestRating:this.stopObject.GuestRating,TransportLocations:this.stopObject.TransportLocations}).then(t=>{this.generalLink=this.stopObject.GeneralTempLink;let e=this.getParent("EditRoundtrips").stops,i=e[e.findIndex(t=>t.DocId===this.stopObject.DocId)];i.HotelLocation=this.stopObject.HotelLocation,i.HotelStars=this.hotelStars,i.HotelContact=this.stopObject.HotelContact,i.HotelName=this.stopObject.HotelName,i.GeneralLink=this.stopObject.GeneralTempLink,i.CheckOutDate=this.checkOutDate,i.HotelPrice=this.stopObject.HotelPrice,i.GuestRating=this.stopObject.GuestRating,console.log(e.TransportLocations),console.log(this.stopObject.TransportLocations),e.TransportLocations=this.stopObject.TransportLocations,this.$q.notify({color:"green-4",textColor:"white",icon:"check_circle",message:"Hotel wurde hinzugefügt"})})},removeHotel(){s["b"].collection("RoundtripDetails").doc(this.stopObject.DocId).update({HotelLocation:null,HotelStars:null,HotelContact:null,HotelName:null,GeneralLink:null,HotelPrice:null,GuestRating:null,TransportLocations:null}).then(t=>{this.stopObject.HotelName=null;let e=this.getParent("EditRoundtrips").stops,i=e[e.findIndex(t=>t.DocId===this.stopObject.DocId)];i.HotelLocation=null,i.HotelStars=null,i.HotelContact=null,i.HotelName=null,i.GeneralLink=null,i.CheckOutDate=null,i.HotelPrice=null,i.GuestRating=null,i.TransportLocations=null,this.$q.notify({color:"green-4",textColor:"white",icon:"check_circle",message:"Hotel wurde entfernt"})})},addDailyTrip(){let t=this;if(this.tempDailyTripDate&&this.tempDailyTripLocation&&this.dailyTripProfile){t.addDailyTripDialogVisible=!1;let e={id:this.dailyTrips.length,date:this.tempDailyTripDate,location:this.tempDailyTripLocation,descriptionInput:"Tagesausflug nach "+this.tempDailyTripLocation.label.split(",")[0],profile:this.getDailyTripProfile()};this.dailyTrips.push(e),this.dailyTrips.sort(this.compare),this.dailyTrips.forEach((t,e)=>{t.newDate=this.newDailyTripDate(t.date),0===e?this.getDailyTripDuration([this.location.lng,this.location.lat],[t.location.lng,t.location.lat],t.profile,0,this.location.label,this.location.label,t):this.getDailyTripDuration([this.dailyTrips[e-1].location.lng,t.location.lat],[t.location.lng,t.location.lat],t.profile,e,this.dailyTrips[e-1].location.label,this.location.label,t)}),s["b"].collection("RoundtripDetails").doc(this.stopObject.DocId).update({DailyTrips:this.dailyTrips}).then(t=>{p["a"].showSuccessNotification("Tagesausflug wurde hinzugefügt")})}else p["a"].showErrorNotification("Bitte überprüfe deine Angaben")},changeAllDates(){let t=p["a"].getDateFromString(this.date).valueOf()-p["a"].getDateFromString(this.oldDate).valueOf();this.oldDate=this.date,this.getParent("EditRoundtrips").changeAllFollowingStopDates(this.stopObject.DocId,t,p["a"].getDateFromString(this.date))},openInNewTab(t){window.open(t,"_blank")},deleteDailyTrip(t){if(null===this.stopObject.DocId||""===this.stopObject.DocId||"undefined"===this.stopObject.DocId)return this.$q.notify({color:"red-5",textColor:"white",icon:"error",message:"Der Eintrag konnte nicht gelöscht werden"}),!1;this.dailyTrips.splice(t,1),this.dailyTrips.sort(this.compare),this.dailyTrips.forEach((t,e)=>{t.newDate=this.newDailyTripDate(t.date),0===e?this.getDailyTripDuration([this.location.lng,this.location.lat],[t.location.lng,t.location.lat],t.profile,e,this.location.label,this.location.label,t):this.getDailyTripDuration([this.dailyTrips[e-1].location.lng,t.location.lat],[t.location.lng,t.location.lat],t.profile,e,this.dailyTrips[e-1].location.label,this.location.label,t)}),s["b"].collection("RoundtripDetails").doc(this.stopObject.DocId).update({DailyTrips:this.dailyTrips}).then(t=>(this.$q.notify({color:"green-4",textColor:"white",icon:"check_circle",message:"Tagesausflug wurde gelöscht"}),!0))},saveSights(){if(this.addedSights!==this.oldAddedSights){this.oldAddedSights=this.addedSights;let t=this.getParent("EditRoundtrips").stops;t[t.findIndex(t=>t.DocId===this.stopObject.DocId)].Sights=this.addedSights,this.saveData("Sights",this.addedSights,!1)}},newDailyTripDate(t){return(!u||t.split(" ")[0]!==u.split(" ")[0])&&(u=t,!0)},saveDailyTrips(t,e,i){"description"===i?this.dailyTrips[t].descriptionInput=e:"sights"===i?this.dailyTrips[t].addedSights=e:"date"===i&&(this.dailyTrips[t].date=e),this.saveData("DailyTrips",this.dailyTrips,!1)},saveDailyTripImgs(t,e){this.dailyTrips[t].stopImages=e,this.saveData("DailyTrips",this.dailyTrips,!1)},saveData(t,e,i){try{let a=this;s["b"].collection("RoundtripDetails").doc(this.stopObject.DocId).update({[""+t]:e}).then((function(){"Location"===t&&a.getParent("EditRoundtrips").fetchAndSaveCountries(),i&&a.getParent("EditRoundtrips").fetchRoundtripStops(a.$route.params.id,!1)}))}catch(a){console.log(a)}},scrollTo(t){const e=400;d(document.documentElement,t,e)},saveWork(){this.saveSights(),this.saveData("Description",this.descriptionInput,!1);let t=this.getParent("EditRoundtrips").stops;t[t.findIndex(t=>t.DocId===this.stopObject.DocId)].Description=this.descriptionInput,this.savedEditorContent=this.descriptionInput},updateLocation(t){null!==t&&this.location.label!==t.label&&(this.tempLocation={lng:t.x,lat:t.y,label:t.label})},updateParkLocation(t){null!==t&&(this.tempParkingPlace={lng:t.x,lat:t.y,label:t.label})},updateDailyTripLocation(t){this.tempDailyTripLocation=null!==t?{lng:t.x,lat:t.y,label:t.label}:null},getDailyTripProfile(){switch(this.dailyTripProfile){case"zu Fuß":return"walking";case"Fahrrad":return"cycling";default:return"driving"}},capitalize(t){return t=t.toLowerCase(),t=t.charAt(0).toUpperCase()+t.slice(1),t},formatOn(){this.preventPasting=!this.preventPasting},pasteCapture(t){if(this.preventPasting){let e,i;t.preventDefault(),t.originalEvent&&t.originalEvent.clipboardData.getData?(e=t.originalEvent.clipboardData.getData("text/plain"),this.$refs.editor_ref.runCmd("insertText",e)):t.clipboardData&&t.clipboardData.getData()?(e=t.clipboardData.getData("text/plain"),this.$refs.editor_ref.runCmd("insertText",e)):window.clipboardData&&window.clipboardData.getData&&(i||(i=!0,this.$refs.editor_ref.runCmd("ms-pasteTextOnly",e)),i=!1)}},showImgDialog(t){this.dialogImgSrc=t,this.imgDialogVisible=!0},addImageToStop(t){this.stopImages||(this.stopImages=[]),this.stopImages.push(t),this.tempImgLink="",this.$refs.tempImgLinkInput.resetValidation();let e=this.getParent("EditRoundtrips").stops;e[e.findIndex(t=>t.DocId===this.stopObject.DocId)].StopImages=this.stopImages,s["b"].collection("RoundtripDetails").doc(this.stopObject.DocId).update({StopImages:this.stopImages}).catch((function(t){p["a"].showErrorNotification("Das Bild konnte nicht hinzugefügt werden"),console.log(t)}))},removeImg(t){if(!this.stopImages)return;this.stopImages.splice(t,1);let e=this.getParent("EditRoundtrips").stops;e[e.findIndex(t=>t.DocId===this.stopObject.DocId)].StopImages=this.stopImages,s["b"].collection("RoundtripDetails").doc(this.stopObject.DocId).update({StopImages:this.stopImages}).catch((function(t){p["a"].showErrorNotification("Der Eintrag konnte nicht gelöscht werden"),console.log(t)}))},deleteEntry(){if(null===this.stopObject.DocId||""===this.stopObject.DocId||"undefined"===this.stopObject.DocId)return this.$q.notify({color:"red-5",textColor:"white",icon:"error",message:"Der Eintrag konnte nicht gelöscht werden"}),!1;if(this.getParent("EditRoundtrips").removeStop(this.stopObject.DocId),this.$store.getters["demoSession/isInDemoSession"])this.$store.commit("demoSession/removeStop",this.stopObject.DocId);else{const t=this;s["b"].collection("RoundtripDetails").doc(t.docId).delete().then((function(){p["a"].showSuccessNotification("Eintrag wurde gelöscht")})).catch((function(t){console.log(t),p["a"].showErrorNotification("Der Eintrag konnte nicht gelöscht werden")}))}},dailyTripDateOptions(t){if(this.date&&this.date.length>0){let e=this.date.split(" "),i=e[0].split(".");const a=new Date(i[2],i[1]-1,i[0]),o=new Date(t);if(this.nextStopDate&&this.nextStopDate.length>0){e=this.nextStopDate.split(" "),i=e[0].split(".");const t=new Date(i[2],i[1]-1,i[0]);return o>=a&&o<=t}return o>=a}return null},getParent(t){let e=this.$parent;while("undefined"!==typeof e){if(e.$options.name===t)return e;e=e.$parent}return!1},searchSights(){this.location.lng&&this.location.lat&&p["a"].getSights(this.location.lng,this.location.lat).then(t=>{this.sights=null!==t?t.data.data:"error"})},compare(t,e){const i=p["a"].getDateFromString(t.date),a=p["a"].getDateFromString(e.date);return i>a?1:a>i?-1:0}},created(){this.oldAddedSights=this.addedSights,this.oldDate=this.date,this.dailyTrips.sort(this.compare),this.dailyTrips.forEach((t,e)=>{t.newDate=this.newDailyTripDate(t.date),0===e?this.getDailyTripDuration([this.location.lng,this.location.lat],[t.location.lng,t.location.lat],t.profile,e,this.location.label,this.location.label,t):this.getDailyTripDuration([this.dailyTrips[e-1].location.lng,t.location.lat],[t.location.lng,t.location.lat],t.profile,e,this.dailyTrips[e-1].location.label,this.location.label,t)})},mounted(){this.lastItem&&p["a"].scrollToOffset(this.$refs.lastTimelineEntry)}},m=g,b=i("2877"),D=Object(b["a"])(m,a,o,!1,null,null,null);e["default"]=D.exports}}]);