(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"0603":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"map",staticStyle:{overflow:"hidden"}},[i("q-inner-loading",{staticStyle:{"z-index":"1"},attrs:{showing:t.loading}},[i("q-spinner",{attrs:{size:"42px",color:"primary"}}),i("p",{staticClass:"font-medium",staticStyle:{"margin-top":"10px"}},[t._v("Karte wird geladen")])],1),t.accTo?i("MglMap",{style:"height:"+(t.height?t.height:"500px;"),attrs:{accessToken:t.accTo,mapStyle:t.mapStyle,center:t.centerLocation,zoom:6,mapboxGl:t.mapbox,attributionControl:!1,logoPosition:"bottom-left",keyboard:"",doubleClickZoom:""},on:{"update:mapStyle":function(e){t.mapStyle=e},"update:map-style":function(e){t.mapStyle=e},load:t.onMapLoaded}},[t.editor&&!t.isDemo?i("MglGeocoderControl",{attrs:{accessToken:t.accTo,placeholder:"Ort suchen"},on:{result:t.handleSearch}}):t._e(),i("MglNavigationControl",{attrs:{position:"top-right"}}),i("MapLayerPlugin",{staticClass:"mapboxgl-ctrl",attrs:{position:"top-right"}}),t.editor?i("q-btn",{staticStyle:{position:"absolute",right:"9px",top:"220px"},attrs:{color:"white","text-color":"secondary",icon:"apartment"},on:{click:function(e){t.showSuggestionCountryDialog=!0,t.showDrawerList=!1,t.miniDisabled=!0}}}):t._e(),i("MglFullscreenControl",{attrs:{position:"bottom-right"}}),t._l(t.stops,(function(e){return i("MglMarker",{key:e.DocId,ref:"stopMarker"+e.DocId,refInFor:!0,attrs:{coordinates:e.HotelName&&e.HotelLocation&&!isNaN(e.HotelLocation.lat)?[e.HotelLocation.lat,e.HotelLocation.lng]:[e.Location.lng,e.Location.lat],color:"#D56026"},on:{click:function(i){return t.onMarkerClicked(i,e.HotelLocation?e.HotelLocation.label:e.Location.label)}}},[i("MglPopup",[i("q-card",[e.StopImages?i("q-img",{attrs:{width:"240px",height:"135px",src:e.StopImages[0]}}):i("q-img",{attrs:{width:"240px",height:"135px",src:t.lastPOICityData.imgSrcs?t.lastPOICityData.imgSrcs[0]:t.lastPOICityData.img?t.lastPOICityData.img:null}}),i("q-card-section",[i("div",{staticClass:"font-large",staticStyle:{"line-height":"normal"}},[t._v("\n              "+t._s(e.Title)+"\n            ")]),i("div",{staticStyle:{"font-size":"13px"}},[t._v("\n              "+t._s(t.lastPOICityData.shortDescription)+"\n              "),e.GeneralLink&&e.GeneralLink.length>0?i("p",[i("q-icon",{attrs:{name:"house"}}),i("a",{attrs:{href:e.GeneralLink,target:"blank"}},[t._v(t._s(t.capitalize(e.HotelName)))])],1):t._e()])]),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"show",rawName:"v-show",value:e,expression:"stop"}],attrs:{flat:"",label:"POIs",color:"secondary"},on:{click:function(i){return t.showSightDetails(e.Location.lat,e.Location.lng)}}})],1)],1)],1)],1)})),t._l(t.stops,(function(e){return t._l(e.DailyTrips,(function(a){return i("MglMarker",{key:a.id,attrs:{coordinates:[a.location.lng,a.location.lat],color:"#D56026"},on:{click:function(e){return t.onMarkerClicked(e,a.location.label)}}},[i("MglPopup",[i("q-card",[a.StopImages?i("q-img",{attrs:{width:"240px",height:"135px",src:a.StopImages[0]}}):t._e(),i("q-card-section",[i("div",{staticClass:"text-h6"},[t._v("\n                "+t._s(a.location.label.split(",")[0])+" - Tagesausflug von "+t._s(e.Location.label?e.Location.label.split(",")[0]:"")+"\n              ")]),i("div",{staticClass:"text-subtitle2"},[i("p",{staticStyle:{"margin-bottom":"5px"}},[i("q-icon",{attrs:{name:"location_on"}}),i("a",{attrs:{target:"_blank",href:"https://www.google.com/maps/search/?api=1&query="+a.location.label}},[t._v(t._s(a.location.label))])],1)])])],1)],1)],1)}))})),t.editor?i("MglMarker",{ref:"addStopMarker",attrs:{coordinates:t.lastClickCoordinates,color:"#70707075",offset:[5,10]},on:{click:function(e){return t.onMarkerClicked(e,t.title)}}},[i("MglPopup",[i("q-card",[i("q-img",{directives:[{name:"show",rawName:"v-show",value:t.lastPOICityData.img,expression:"lastPOICityData.img"}],attrs:{src:t.lastPOICityData.imgSrcs?t.lastPOICityData.imgSrcs[0]:t.lastPOICityData.img?t.lastPOICityData.img:null}}),i("q-card-section",{staticStyle:{"padding-left":"10px","padding-top":"10px"}},[i("span",{staticClass:"font-large",staticStyle:{"line-height":"normal"}},[t._v(t._s(t.title?t.title:"gesetzter Punkt"))]),i("div",{staticStyle:{"font-size":"13px"}},[t._v("\n              "+t._s(t.lastPOICityData.shortDescription)+"\n            ")])]),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{attrs:{flat:"",label:"Infos",color:"secondary"},on:{click:function(e){return t.showSightDetails(t.lastClickCoordinates[1],t.lastClickCoordinates[0])}}}),t.isDemo?t._e():i("q-btn",{attrs:{flat:"",label:"Ort hinzufügen",color:"primary"},on:{click:t.addStop}})],1)],1)],1)],1):t._e(),i("q-dialog",{model:{value:t.showDetailsDialog,callback:function(e){t.showDetailsDialog=e},expression:"showDetailsDialog"}},[t.lastPOICityData?i("div",[i("q-card",[i("q-carousel",{attrs:{animated:"",arrows:"",infinite:"",swipeable:"",autoplay:""},model:{value:t.slide,callback:function(e){t.slide=e},expression:"slide"}},t._l(t.lastPOICityData.imgSrcs,(function(t,e){return i("q-carousel-slide",{key:e,staticClass:"column no-wrap",staticStyle:{padding:"0"},attrs:{name:e,"img-src":t}})})),1),i("q-card-section",[i("div",{staticStyle:{"padding-left":"10px","padding-top":"10px"}},[i("span",{staticClass:"font-large"},[t._v(t._s(t.lastPOICityData.title))]),i("div",[t._v("\n                "+t._s(t.lastPOICityData.description)+"\n              ")]),i("div",{staticClass:"font-medium",staticStyle:{"padding-top":"20px","padding-bottom":"10px"}},[t._v(t._s(t.suggestedPOIs.length)+" Top Sehenswürdigkeiten")])]),t._l(t.suggestedPOIs,(function(e,a){return i("q-card",{key:a,staticClass:"city-card cursor-pointer",attrs:{id:"POI"+e.name},on:{mouseover:function(i){return t.markPOIOnMap(e)},mouseleave:function(i){return t.hidePOIOnMap(e)},click:function(i){return t.flyTo(e.location.lat,e.location.lng)}}},[i("div",[i("div",[e.photoUrl?i("q-img",{staticStyle:{height:"170px"},attrs:{alt:"Bild von"+e.name,src:e.photoUrl,"placeholder-src":"statics/dummy-image-landscape-1-150x150.jpg"}},[i("div",{staticClass:"absolute-bottom text-h6 ellipsis"},[t._v(t._s(e.name)+"\n                      "),i("q-tooltip",[t._v(t._s(e.name))])],1)]):t._e()],1),t.isStopAlreadyAdded(t.lastPOICityData.title)?[i("q-btn",{directives:[{name:"show",rawName:"v-show",value:!t.sightAlreadyAdded(e.name,t.lastPOICityData.title),expression:"!sightAlreadyAdded(poi.name, lastPOICityData.title)"}],staticClass:"sight-add-button",attrs:{icon:"bookmark",color:"primary",round:""},on:{click:function(i){return t.$emit("addSight",{poi:e,cityName:t.lastPOICityData.title})}}},[i("q-tooltip",[t._v("Ort merken")])],1),i("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.sightAlreadyAdded(e.name,t.lastPOICityData.title),expression:"sightAlreadyAdded(poi.name, lastPOICityData.title)"}],staticClass:"sight-add-button",attrs:{icon:"done",color:"primary",disable:"",round:""}})]:t._e(),i("div",{staticClass:"rating-text"},[t._v("\n                  "+t._s(e.rating)+"\n                  "),i("q-rating",{staticClass:"stars",staticStyle:{"margin-right":"10px"},attrs:{value:e.rating,size:"15px",color:"gold",readonly:""}}),t._v("\n                  ("+t._s(e.totalRatings)+")\n                ")],1),i("a",{attrs:{href:"https://www.google.com/maps/search/?api=1&query="+e.name,target:"_blank"}},[i("q-card-section",{staticStyle:{color:"#707070"}},[i("q-icon",{attrs:{name:"location_on"}}),t._v("\n                    "+t._s(e.location.label)+"\n                  ")],1)],1)],2)])}))],2)],1)],1):t._e()]),t._l(t.stops,(function(e,a){return i("div",{key:"StopContainer"+e.DocId+a},[e.Parking&&!isNaN(e.Parking.lng)?i("MglMarker",{key:"Stop"+e.DocId,attrs:{coordinates:[e.Parking.lng,e.Parking.lat],color:"#D56026"},on:{click:function(e){return t.onMarkerClicked(e)}}},[i("MglPopup",[i("q-card",[i("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center","padding-top":"5px"}},[i("q-icon",{attrs:{name:"fas fa-parking",size:"30px"}})],1),i("q-card-section",[i("p",[t._v(t._s(e.parkingPlace&&e.parkingPlace.label&&"undefined"!==typeof e.parkingPlace.label?e.Parking.label.split(",")[0]:"Parkplatz für "+e.Title))])])],1)],1)],1):t._e()],1)})),t.showCityMarkers?t._l(t.suggestedCities,(function(e,a){return i("MglMarker",{key:e.name+a,ref:"cityMarker"+a,refInFor:!0,attrs:{coordinates:[e.longitude,e.latitude],offset:[10,5]},on:{click:function(i){t.onMarkerClicked(i,e.name),t.goToCity(e.name)}}},[i("q-icon",{ref:"cityMarkerIcon"+a,refInFor:!0,attrs:{slot:"marker",name:"place",color:"amber-14",size:"30px"},slot:"marker"}),i("MglPopup",[i("q-card",[i("q-img",{directives:[{name:"show",rawName:"v-show",value:t.lastPOICityData.img,expression:"lastPOICityData.img"}],attrs:{src:t.lastPOICityData.img&&"https:"===t.lastPOICityData.img.split("/")[0]?t.lastPOICityData.img:t.lastPOICityData.imgSrcs?t.lastPOICityData.imgSrcs[0]:""}}),i("q-card-section",{staticStyle:{"padding-left":"10px","padding-top":"10px"}},[i("span",{staticClass:"font-large",staticStyle:{"line-height":"normal"}},[t._v(t._s(e.name?e.name:"gesetzter Punkt"))]),i("div",{staticStyle:{"font-size":"13px"}},[t._v("\n                "+t._s(t.lastPOICityData.shortDescription)+"\n                "),i("br"),i("br"),t._v("\n                vorgeschlagen für "+t._s(t.suggestionCountry)+"\n              ")])]),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{attrs:{flat:"",label:"Infos",color:"secondary"},on:{click:function(i){return t.showSightDetails(e.latitude,e.longitude)}}}),t.isStopAlreadyAdded(e.name)||t.isDemo?t.isDemo?t._e():i("q-btn",{attrs:{label:"Ort ansehen",color:"primary"},on:{click:function(i){t.$refs["stopMarker"+t.isStopAlreadyAdded(e.name).DocId][0].marker._popup.addTo(t.map),t.$refs["cityMarker"+a][0].marker._popup.remove()}}}):i("q-btn",{attrs:{flat:"",label:"Ort hinzufügen",color:"primary"},on:{click:t.addStop}})],1)],1)],1)],1)})):t._e(),t.showPOIMarkers?t._l(t.suggestedPOIs,(function(e,a){return i("MglMarker",{key:e.name+a,attrs:{coordinates:[e.location.lng,e.location.lat],offset:[10,5]},on:{click:function(i){t.onMarkerClicked(i,e.name),t.goToCity(e.name)}}},[i("q-icon",{ref:"poiMarkerIcon"+a,refInFor:!0,attrs:{slot:"marker",name:"place",color:"amber-14",size:"30px"},slot:"marker"}),i("MglPopup",[i("q-card",[i("q-card-section",[i("div",{staticClass:"text-h6"},[t._v("\n                "+t._s(e.name)+"\n              ")]),i("p",{staticStyle:{"font-size":"14px"}},[t._v("vorgeschlagener Ort für "+t._s(e.location.label.substring(e.location.label.lastIndexOf(",")+1,e.location.label.length)))])])],1)],1)],1)})):t._e(),t._l(t.addedRoutes,(function(e,a){return i("MglMarker",{key:"route"+a,ref:"route"+e.id,refInFor:!0,attrs:{coordinates:e.location,color:e.color},on:{click:function(e){return t.onMarkerClicked(e)}}},[i("q-icon",{ref:"speedMarker"+e.id,refInFor:!0,class:"speedMarker"+a,style:{color:e.color,"background-color":"white","border-radius":"50%"},attrs:{slot:"marker",name:"speed"},slot:"marker"}),i("MglPopup",[e.duration?i("q-card",[i("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center","padding-top":"5px"}},[i("q-icon",{attrs:{name:"fas fa-route",size:"30px"}})],1),i("q-card-section",[i("div",[t._v(t._s(e.duration)+" "+t._s(e.origin?"von "+e.origin:"")+" bis "+t._s(e.destination)+" "+t._s(null!==e.distance?"("+e.distance+")":null))]),e.origin!==e.destination?i("a",{attrs:{target:"_blank",href:"https://www.google.com/maps/dir/?api=1&origin="+e.origin+"&destination="+e.destination}},[t._v("auf Google ansehen")]):t._e()])],1):i("q-card",[i("q-card-section",[i("div",[t._v(t._s(e.distance)+" mit dem Flugzeug "+t._s(t.addedRoutes[a-1]?"von "+t.addedRoutes[a-1].destination:"")+" nach "+t._s(e.destination))])])],1)],1)],1)}))],2):t._e(),i("q-dialog",{model:{value:t.showSuggestionCountryDialog,callback:function(e){t.showSuggestionCountryDialog=e},expression:"showSuggestionCountryDialog"}},[i("q-card",[i("q-card-section",{staticClass:"font-medium"},[i("p",[t._v("Land für Städtevorschläge wählen")]),i("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:t.countryOptions,label:"Land auswählen","bg-color":"white",rules:[function(t){return null!==t&&""!==t||"Bitte wähle ein Land"}]},on:{filter:t.filterCountries,input:function(e){t.showCitiesOnMap(),t.showSuggestionCountryDialog=!1}},scopedSlots:t._u([{key:"prepend",fn:function(){return[i("q-icon",{attrs:{name:"explore"}})]},proxy:!0},{key:"no-option",fn:function(){return[i("q-item",[i("q-item-section",{staticClass:"text-grey"},[t._v("\n                Keine Ergebnisse\n              ")])],1)]},proxy:!0}]),model:{value:t.suggestionCountry,callback:function(e){t.suggestionCountry=e},expression:"suggestionCountry"}})],1)],1)],1)],1)},o=[],n=i("e192"),s=i.n(n),r=i("bc3a"),l=i.n(r),c=i("1261"),d=i("15c8"),u={getCities(t,e){return new Promise((i,a)=>{let o=this;o.fetchDBSuggestions(t).then((function(a){a.length>0?i(a):o.fetchAPISuggestions(t,e).then((function(t){i(t)})).catch((function(t){console.log("Error"+t),i(null)}))})).catch((function(t){console.log("Error"+t),i(null)}))})},fetchDBSuggestions(t){return new Promise((e,i)=>{let a=[],o=c["b"].collection("SuggestedCities").where("Country","==",t).limit(1);o.get().then(t=>{t.empty&&e(a),t.forEach(t=>{let i=t.data().Cities;0===i.length&&e(a),i.forEach(o=>{let n={name:o.name,region:o.region,longitude:o.location?o.location.lng:null,latitude:o.location?o.location.lat:null,country:t.data().Country};a.push(n),i.indexOf(o)===i.length-1&&e(a)})})})})},fetchAPISuggestions(t,e){return new Promise((i,a)=>{let o=this;l.a.get("https://wft-geo-db.p.rapidapi.com/v1/geo/countries?limit=5&offset=0&namePrefix="+t+"&languageCode=de",{headers:{"X-RapidAPI-Key":e.$store.getters["api/getGeoDBKey"]}}).then((function(t){t.data.data[0]||d["a"].showErrorNotification("Für diesen Ort wurde nichts gefunden"),setTimeout((function(){l.a.get("https://wft-geo-db.p.rapidapi.com/v1/geo/cities?countryIds="+t.data.data[0].code+"&minPopulation=70000&sort=-population&languageCode=de&types=CITY",{headers:{"X-RapidAPI-Key":e.$store.getters["api/getGeoDBKey"]}}).then((function(t){o.writeInDB(t.data.data),i(t.data.data)})).catch((function(t){console.log(t)}))}),2e3)})).catch((function(t){console.log("Error"+t)}))})},writeInDB(t){let e={Cities:[]};t.forEach((t,i)=>{e.Country=t.country,e.Cities.includes(t.name)||e.Cities.push({name:t.name,region:t.region,location:{lng:t.longitude,lat:t.latitude}})}),c["b"].collection("SuggestedCities").add(e)},getCityImage(t,e,i){let a=i.$store.getters["api/getPixabayKey"];return new Promise((i,o)=>{l.a.get("https://pixabay.com/api/?key="+a+"&lang=de&category=buildings&image_type=photo&orientation=horizontal&safesearch=true&min_height=40&per_page=3&q="+t+" "+e,{}).then((function(e){e.data.hits[0]?i({url:e.data.hits[0].webformatURL,cityName:t}):l.a.get("https://pixabay.com/api/?key="+a+"&lang=de&category=buildings&image_type=photo&orientation=horizontal&safesearch=true&min_height=40&per_page=3&q="+t,{}).then((function(e){e.data.hits[0]?i({url:e.data.hits[0].webformatURL,cityName:t}):i({url:"../../statics/dummy-image-landscape-1-150x150.jpg",cityName:t})})).catch((function(t){console.log(t)}))})).catch((function(e){console.log(e),i({url:"../../statics/dummy-image-landscape-1-150x150.jpg",cityName:t})}))})}},p=i("3f3d"),g=i("bd4c"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mapbox-ctrl mapbox-ctrl-group"},[i("q-btn",{staticStyle:{position:"absolute",right:"9px",top:"175px"},attrs:{color:"white","text-color":"secondary",icon:"layers"}},[i("q-menu",[i("q-list",{staticStyle:{"min-width":"100px"}},[i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){return t.switchMapStyle(null)}}},[i("q-item-section",[t._v("Standard")])],1),i("q-separator"),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){return t.switchMapStyle("nav")}}},[i("q-item-section",[t._v("Navigation")])],1),i("q-separator"),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){return t.switchMapStyle("sat")}}},[i("q-item-section",[t._v("Satellit")])],1),i("q-separator"),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){return t.switchMapStyle("out")}}},[i("q-item-section",[t._v("Outdoor")])],1)],1)],1)],1)],1)},m=[],f={name:"MapLayerPlugin",inject:["mapbox","map","actions"],methods:{switchMapStyle(t){let e=d["a"].getParent("Map",this);switch(t){case"nav":e.mapStyle="mapbox://styles/mareiski/ckcevjmf81b7t1imouvv52xrh";break;case"out":e.mapStyle="mapbox://styles/mareiski/ckcew03vc12dy1imgq1eonlvt";break;case"sat":e.mapStyle="mapbox://styles/mareiski/ckcevopcq123g1imgb36xu37s";break;default:e.mapStyle="mapbox://styles/mareiski/ck27d9xpx5a9s1co7c2golomn";break}e.loadMap(this.map)}}},y=f,k=i("2877"),b=Object(k["a"])(y,h,m,!1,null,null,null),v=b.exports,S=i("e188");i("ac6d");const C=()=>Promise.resolve().then(i.bind(null,"3f3d")),w=()=>i.e(0).then(i.bind(null,"4133")),_=()=>i.e(0).then(i.t.bind(null,"595b",7));let M=[];const D=()=>Promise.resolve().then(i.t.bind(null,"bc3a",7));let P=null;var x={meta:{link:{material:{rel:"stylesheet",href:"https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css"}}},name:"Map",components:{MglMap:C,MglMarker:p["MglMarker"],MglPopup:p["MglPopup"],MglNavigationControl:p["MglNavigationControl"],MglFullscreenControl:p["MglFullscreenControl"],MglGeocoderControl:w,MapLayerPlugin:v},props:{stops:Array,profile:String,childrenAges:Array,adults:Number,rooms:Number,editor:Boolean,defaultInitDate:String,height:String,isDemo:Boolean},computed:{isMobile(){return window.matchMedia("(max-width: 550px)").matches},accTo(){return this.$store.getters["api/getMapboxKey"]}},data(){return{mapStyle:"mapbox://styles/mareiski/ck27d9xpx5a9s1co7c2golomn",addedRoutes:[],showAddStopMarker:!1,lastClickCoordinates:[0,0],lastClickLocation:{},title:null,mapbox:null,whitelistedLabels:["airport-label","place-label","state-label","poi-label","settlement-label","natural-point-label"],centerLocation:[0,0],markerClicked:!1,showDetailsDialog:!1,drawerLeft:!1,miniState:!0,showDrawerList:!0,miniDisabled:!1,suggestedCities:[],showCityMarkers:!1,showPOIMarkers:!1,suggestedPOIs:[],suggestionDialogVisible:!1,lastPOICityData:{},lastSightDetailsLat:0,lastSightDetailsLng:0,suggestionCountry:null,showSuggestionCountryDialog:!1,countryOptions:S["a"],loading:!0,slide:0}},watch:{stops:function(t,e){JSON.stringify(t)!==JSON.stringify(e)&&this.loadMap(this.map)}},methods:{update(t){this.$emit("update",t)},filterCountries(t,e,i){e(()=>{const e=t.toLowerCase();this.countryOptions=S["a"].filter(t=>t.toLowerCase().indexOf(e)>-1)})},isStopAlreadyAdded(t){return this.stops[this.stops.findIndex(e=>e.Location.label===t)]},sightAlreadyAdded(t,e){let i=this.stops[this.stops.findIndex(t=>t.Location.label===e)];return i&&i.Sights.includes(t)},onMapLoaded(t){console.log("onmaploaded"),this.loading=!1,this.map=t.map;let e=this;this.loadMap(t.map).then(t=>{setTimeout((function(){e.fitToBounds(M)}),1e3)})},fitToBounds(t){try{t.length>1&&_().then(e=>{var i=e.lineString(t),a=e.bbox(i);this.map.fitBounds(new s.a.LngLatBounds(a),{padding:80})})}catch(e){console.log(e)}},markCityOnMap(t){this.changeCityMarkerSize("50px",t)},hideCityOnMap(t){this.changeCityMarkerSize("30px",t)},changeCityMarkerSize(t,e){const i=this;this.suggestedCities.forEach((a,o)=>{const n=[a.latitude,a.longitude];e[0]===n[0]&&e[1]===n[1]&&(i.$refs["cityMarkerIcon"+o][0].size=t)})},markPOIOnMap(t){this.changePOIMarkerSize("50px",t)},hidePOIOnMap(t){this.changePOIMarkerSize("30px",t)},changePOIMarkerSize(t,e){const i=this;this.suggestedPOIs.forEach((a,o)=>{const n=[a.location.lat,a.location.lng];e[0]===n[0]&&e[1]===n[1]&&(i.$refs["poiMarkerIcon"+o][0].size=t)})},showCitiesOnMap(){u.getCities(this.suggestionCountry,this).then(t=>{if(!t)return;this.suggestedCities=t,this.showPOIMarkers&&(this.showPOIMarkers=!1,this.showCityMarkers=!0);let e=[];this.suggestedCities.forEach(t=>{e.push([t.longitude,t.latitude])}),this.fitToBounds(e),this.showCityMarkers=!0})},goToCity(t){const e=this.$refs["DrawerScrollArea"],i=document.getElementById("CitySuggestion"+t);if(i){const t=i.offsetTop;e.setScrollPosition(t-20,400)}},showPOIsOnMap(t){this.showCityMarkers=!1,this.suggestedPOIs=t,this.showPOIMarkers=!0;let e=[];this.suggestedPOIs.forEach(t=>{e.push([t.location.lng,t.location.lat])}),this.fitToBounds(e)},switchDrawerToList(){this.miniDisabled=!1,this.miniState=!0,this.showDrawerList=!0,this.showCityMarkers=!1},handleSearch(t){let e=t.result;if(!this.markerClicked){this.lastClickCoordinates=e.geometry.coordinates;let t=e.place_name;t.includes(",")&&(t=t.split(",")[0]),this.title=t,this.showAddStopMarker=!0,this.loadMarkerInfos(t);let i=this;i.$refs.addStopMarker.marker._popup.options.showed||setTimeout((function(){i.$refs.addStopMarker.togglePopup()}),100)}this.markerClicked=!1},onMarkerClicked(t,e){this.lastPOICityData={title:e,description:"",shortDescription:"",img:"",imgSrcs:[]},this.loadMarkerInfos(e),t.map.flyTo({center:t.component.marker._lngLat,speed:.5,curve:1}),this.markerClicked=!0},showSightDetails(t,e){t!==this.lastSightDetailsLat||e!==this.lastSightDetailsLng?(d["a"].getGooglePlacesData(t,e,this).then(t=>{this.suggestedPOIs=t,this.showDetailsDialog=!0}).catch(t=>{console.log(t)}),this.lastSightDetailsLat=t,this.lastSightDetailsLng=e):this.showDetailsDialog=!0},addStop(){if(this.showAddStopMarker=!1,this.lastClickLocation.label=this.title,this.lastClickLocation.lat=this.lastClickCoordinates[1],this.lastClickLocation.lng=this.lastClickCoordinates[0],this.stops[this.stops.length-1]&&this.stops[this.stops.length-1].InitDate){const t=this.stops[this.stops.length-1].InitDate;let e=d["a"].getDateFromString(t);const i=e;i.setDate(e.getDate()+1);const a=g["b"].formatDate(i,"DD.MM.YYYY HH:mm");this.$emit("addStop",{date:a,location:JSON.parse(JSON.stringify(this.lastClickLocation))})}else this.$emit("addStop",{date:null,location:JSON.parse(JSON.stringify(this.lastClickLocation))});this.lastClickCoordinates=[0,0],this.loadMap(this.map).then(t=>{this.map.flyTo({center:this.lastClickLocation,zoom:6,speed:.5,curve:1}),this.$refs.addStopMarker.marker._popup.remove()})},getChildrenText(){let t="&group_children="+this.childrenAges.length;return this.childrenAges.forEach(e=>{t+="&age="+e}),t},getExpediaChildrenText(){let t=null;return this.childrenAges.forEach((e,i)=>{t+=(0!==i?"_":"")+e}),t},getRandomColor(t,e){var i,a,o,n=t/e,s=~~(6*n),r=6*n-s,l=1-r;switch(s%6){case 0:i=1,a=r,o=0;break;case 1:i=l,a=1,o=0;break;case 2:i=0,a=1,o=r;break;case 3:i=0,a=l,o=1;break;case 4:i=r,a=0,o=1;break;case 5:i=1,a=0,o=l;break}var c="#"+("00"+(~~(255*i)).toString(16)).slice(-2)+("00"+(~~(255*a)).toString(16)).slice(-2)+("00"+(~~(255*o)).toString(16)).slice(-2);return c},capitalize(t){return t&&(t=t.toLowerCase(),t=t.charAt(0).toUpperCase()+t.slice(1)),t},loadMap(t,e){return new Promise(i=>{if(null===t&&(t=this.map),e&&(this.stops=e),t){this.addedRoutes.forEach(e=>{t.setLayoutProperty(e.id,"visibility","none")}),this.addedRoutes=[],this.$emit("distanceUpdate",-1),this.stops.forEach((e,i)=>{i>=1&&this.getRoute(this.stops[i-1].Location,e.Location,t,i,this.stops[i-1].Profile,!1),e.DailyTrips&&e.DailyTrips.forEach((a,o)=>{o>=1?a.newDate?(this.getRoute(e.Location,a.location,t,i+o,e.Profile,!0),this.getRoute(e.DailyTrips[o-1].location,e.Location,t,i+i+o,e.Profile,!0)):this.getRoute(e.DailyTrips[o-1].location,a.location,t,i+o,e.Profile,!0):this.getRoute(e.Location,a.location,t,i+o,e.Profile,!0),o===e.DailyTrips.length-1&&this.getRoute(a.location,e.Location,t,o+i,e.Profile,!0)}),0!==M.length?M.forEach((t,i)=>{const a=parseFloat(e.Location.lng),o=parseFloat(e.Location.lat);return(t[0]!==a||t[1]!==o)&&(i===M.length-1?(M.push([a,o]),!0):void 0)}):M.push([parseFloat(e.Location.lng),parseFloat(e.Location.lat)])});let e=this;t.on("click",(function(i){if(!e.markerClicked){e.lastPOICityData={title:"Laden...",description:"",shortDescription:"",img:"",imgSrcs:[]};var a=t.queryRenderedFeatures(i.point),o=["properties","id","layer","geometry"],n=a.map((function(t){var e={};return o.forEach((function(i){e[i]=t[i]})),e}));n.forEach(i=>{if(e.whitelistedLabels.includes(i.layer.id)&&!e.markerClicked){e.lastClickCoordinates=i.geometry.coordinates,e.title=i.properties.name_de;let a=e.isStopAlreadyAdded(e.title);if(a)return void e.$refs["stopMarker"+a.DocId][0].marker._popup.addTo(t);e.showAddStopMarker=!0,t.flyTo({center:i.geometry.coordinates,speed:.5,curve:1}),e.$refs.addStopMarker.marker._popup.options.showed||setTimeout((function(){e.$refs.addStopMarker.marker._popup.options.showed||e.$refs.addStopMarker.marker._popup.addTo(t)}),100)}}),e.loadMarkerInfos(e.title)}e.markerClicked=!1})),i(!0)}})},loadMarkerInfos(t){let e=this;t&&(t.includes(",")&&(t=t.split(",")[0]),d["a"].getWikivoyageData(t).then(i=>{u.getCityImage(t,"",e).then(t=>{i&&(i.img=t.url,e.lastPOICityData=i)})}).catch(t=>{console.log(t)}))},flyToPointOnMap(t,e){let i=this;setTimeout((function(){console.log("fly to"),i.map.flyTo({center:[e,t],speed:.8,curve:1,zoom:12})}),null==i.map?3e3:100)},deg2rad(t){return t*(Math.PI/180)},getRoute(t,e,i,a,o,n){let s=this.profile;o&&null!==o&&"undefined"!==typeof o&&(s=o);let r=(n?"1":"0")+a,l=this.getRandomColor(a,this.stops.length);if("plane"!==s){var c="https://api.mapbox.com/directions/v5/mapbox/"+s+"/"+t.lng+","+t.lat+";"+e.lng+","+e.lat+"?geometries=geojson&access_token="+this.accTo;let a=this;D().then(o=>{o.get(c).then(o=>{var n=o.data.routes[0],s=n.geometry.coordinates,c={id:r,type:"Feature",properties:{},geometry:{type:"LineString",coordinates:s}};let u=c.geometry.coordinates,p=u[Math.floor(u.length/2)],g=d["a"].msToTime(1e3*n.duration),h=Math.floor(n.distance/1e3)>0?Math.floor(n.distance/1e3):0,m=h>0?h+" km":null;this.$emit("distanceUpdate",h),null!==g&&a.addedRoutes.push({location:p,duration:g,distance:m,color:l,origin:t.label.split(",")[0],destination:e.label.split(",")[0],id:r}),i.getSource(r)?(i.getSource(r).setData(c),i.setPaintProperty(r,"line-color",l),i.setLayoutProperty(r,"visibility","visible")):(i.addLayer({id:r,type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:c}}},layout:{"line-join":"round","line-cap":"round",visibility:"visible"},paint:{"line-color":l,"line-width":5,"line-opacity":["case",["boolean",["feature-state","hover"],!1],.75,.4]}}),i.on("click",r,(function(t){a.closeAllPopups();let e=a.$refs["route"+r][0];console.log(e),a.markerClicked||e.togglePopup()})),i.getSource(r).setData(c))}).catch((function(t){console.log(t)}))})}else{let o=[[t.lng,t.lat],[e.lng,e.lat]];var u={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:o}}]};i.addSource("route",{type:"geojson",data:u}),i.addLayer({id:r,source:"route",type:"line",paint:{"line-width":2,"line-color":l}});const n=Math.floor((Number(t.lng)+Number(e.lng))/2),s=Math.floor((Number(t.lat)+Number(e.lat))/2);let c=[n,s];this.addedRoutes.push({location:c,duration:null,distance:null,color:l,origin:this.stops[a-1].Location.label.split(",")[0],destination:this.stops[a].Location.label.split(",")[0],id:r})}i.on("mousemove",r,(function(t){t.features.length>0&&(P&&"undefined"!==typeof P&&i.setFeatureState({id:P},{hover:!1}),t.features[0].layer.id&&"undefined"!==typeof t.features[0].layer.id&&(P=t.features[0].layer.id,i.setFeatureState({source:P,id:P},{hover:!0})))})),i.on("mouseleave",r,(function(){P&&"undefined"!==typeof P&&i.setFeatureState({source:P,id:P},{hover:!1}),P=null}))},closeAllPopups(){const t=document.getElementsByClassName("mapboxgl-popup");console.log(t);for(let e=0;e<t.length;e++)console.log(t[e]),t[e].remove()}},created(){M=[],this.centerLocation=[10.451526,51.165691],this.stops[0]&&this.stops[0].Location&&(this.centerLocation=[this.stops[0].Location.lng,this.stops[0].Location.lat]),this.mapbox=s.a,this.map=null,this.loadMap()}},I=x,q=(i("8f40"),i("37e5"),Object(k["a"])(I,a,o,!1,null,"8b81ad70",null));e["default"]=q.exports},"1b01":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"public-user-profile  q-px-lg q-pb-md"},[i("router-link",{attrs:{to:"/benutzer"}},[t._v(t._s(t.isOnPrivateUserPage?"User Ranking ansehen":"zurück zu allen Nutzern"))]),i("h3",{staticClass:"user-name"},[t._v(t._s(t.userName)+" "+t._s(isNaN(t.reputation)?"":"(Reputation: "+t.reputation+")")+"\n    "),t.trustedUser?i("q-badge",{staticStyle:{"border-radius":"50%",padding:"2px","padding-top":"2.5px"},attrs:{align:"top",color:"blue"}},[i("q-icon",{attrs:{name:"done",color:"white",size:"18px"}}),i("q-tooltip",[t._v("Dies ist ein von Roundtrips4you anerkannter User")])],1):t._e(),"Roundtrips4you"===t.userName?i("q-badge",{staticStyle:{"border-radius":"50%",padding:"2px","padding-top":"2.5px"},attrs:{align:"top",color:"primary"}},[i("q-icon",{attrs:{name:"star",color:"white",size:"18px"}}),i("q-tooltip",[t._v("Dies ist der Account von Roundtrips4you : )")])],1):t._e()],1),t.userSince?i("span",[t._v("Mitglied seit "+t._s(t.userSince))]):t._e(),i("br"),t.companyWebsite?i("span",[t._v("Unternehmenswebsite:\n    "),i("a",{on:{click:function(e){return t.openInNewTab(t.companyWebsite)}}},[t._v(t._s(t.companyWebsite))])]):t._e(),i("br"),t.companyDescription?i("span",{staticStyle:{"max-width":"460px"}},[t._v("\n    "+t._s(t.companyDescription)+"\n  ")]):t._e(),i("div",{staticClass:"flex justify-between details-container",staticStyle:{"margin-top":"10px"}},[i("div",[i("h3",[t._v("Reputation")]),i("ul",[i("li",[t._v('100 für "Nutzer der 1. Stunde" Badge')]),i("li",[t._v(t._s(t.publishedRoundtrips?50*t.publishedRoundtrips:0)+" für veröffentlichte Rundreisen")]),i("li",[t._v(t._s(t.userRTEdited?25*t.userRTEdited:0)+" für eigene Rundreisen die bearbeitet wurden")])])]),i("div",[i("h3",[t._v("Inhalte")]),i("ul",[i("li",[t._v(t._s(t.publishedRoundtrips)+" öffentliche Rundreise"+t._s(1===t.publishedRoundtrips?"":"n")+" erstellt")]),i("li",[t._v(t._s(t.userRTEdited?t.userRTEdited:0)+"x wurden Reisen bereits bearbeitet")])])]),i("div",[i("h3"),i("q-img",{attrs:{width:"100px",src:t.userImage}})],1)]),i("div",{staticClass:"badge-container"},[i("h3",[t._v("Badges")]),i("b",[t._v("Erste Schritte")]),i("div",[i("q-badge",{attrs:{color:"secondary"}},[t._v("Nutzer der 1. Stunde")])],1),i("b",[t._v("Reisen")]),i("div",[t.publishedRoundtrips<5?i("q-badge",{attrs:{disabled:t.publishedRoundtrips<1,color:"secondary"}},[t._v("Reiseanfänger "),i("q-tooltip",[t._v("(min. 1 Reise veröffentlicht)")])],1):t._e(),t.publishedRoundtrips<=10?i("q-badge",{attrs:{disabled:t.publishedRoundtrips<5,color:"secondary"}},[t._v("Reiselustiger "),i("q-tooltip",[t._v("(min. 5 Reisen veröffentlicht)")])],1):t._e(),i("q-badge",{attrs:{disabled:t.publishedRoundtrips<=10,color:"secondary"}},[t._v("Reiseexperte "),i("q-tooltip",[t._v("(mehr als 10 Reisen veröffentlicht)")])],1),i("q-badge",{attrs:{disabled:!t.userRTEdited||t.userRTEdited<=5,color:"secondary"}},[t._v("Reisevermittler "),i("q-tooltip",[t._v("(mehr als 5 eigene Rundreisen, die bearbeitet wurden)")])],1)],1)]),i("div",{staticClass:"roundtrip-container"},[i("h3",[t._v("Veröffentlichte Reisen")]),i("q-list",{attrs:{bordered:t.createdRoundtrips.length>0}},[t.showRoundtrips?i("div",[0===t.createdRoundtrips.length?i("div",[i("span",{staticStyle:{"font-size":"18px"}},[t._v(t._s(t.userName)+" hat leider noch keine Rundreisen veröffentlicht.")])]):t._e(),t._l(t.createdRoundtrips,(function(e,a){return i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.RTId,attrs:{clickable:""},on:{click:function(i){return t.$router.push("/rundreise-ansehen/"+e.RTId)}}},[i("q-item-section",{attrs:{avatar:"",top:""}},[i("q-avatar",{staticStyle:{padding:"0"},attrs:{color:"primary","text-color":"white"}},[i("img",{attrs:{src:t.TitleImgs[a]}})])],1),i("q-item-section",[i("q-item-label",{attrs:{lines:"1"}},[t._v(t._s(e.Title)+" - "+t._s(Array.isArray(e.Location)?t.getLocationString(e.Location):e.Location))]),i("q-item-label",{staticStyle:{width:"100px"},attrs:{caption:""}},[t._v("\n              "+t._s(t.getCreatedAtDate(e.createdAt))+"\n              "),i("q-tooltip",[t._v("\n                Diese Rundreise wurde am "+t._s(t.getCreatedAtDate(e.createdAt))+" erstellt\n              ")])],1)],1),i("q-item-section",{attrs:{side:""}},[i("q-icon",{attrs:{name:"keyboard_arrow_right",color:"primary"}})],1)],1)}))],2):i("div",t._l(3,(function(t){return i("q-item",{key:t},[i("q-item-section",{staticStyle:{padding:"8px 10px"},attrs:{avatar:"",top:""}},[i("q-skeleton",{attrs:{size:"40px",type:"QAvatar"}})],1),i("q-item-section",[i("q-skeleton",{staticStyle:{"margin-bottom":"10px"},attrs:{width:"300px",type:"rect"}}),i("q-item-label",{attrs:{caption:""}},[i("q-skeleton",{attrs:{width:"80px",type:"rect"}})],1)],1)],1)})),1)])],1)],1)},o=[],n=i("1261"),s=i("bd4c"),r={data(){return{userName:null,userImage:null,publishedRoundtrips:0,reputation:0,userRTEdited:0,createdRoundtrips:[],showRoundtrips:!1,TitleImgs:[],userSince:null,trustedUser:!1,title:"User",companyWebsite:null,companyDescription:null,isOnPrivateUserPage:!1}},meta(){return{title:"Profil von "+this.title,meta:{description:{name:"description",content:"Profil von "+this.title+" auf roundtrips4you ansehen. Reise planen komplett kostenlos, online und unkompliziert. Dein kostenloser Reiseplaner"}}}},created(){let t=this.$route.params.id;if(t||(this.isOnPrivateUserPage=!0,t=n["a"].user().uid),console.log(t),t){let e=n["b"].collection("User").where("UserUID","==",t).limit(1);e.get().then(t=>{t.forEach(t=>{this.userImage=t.data().UserImage,this.userName=t.data().UserName,this.userRTEdited=t.data().RTEdited,this.userSince=this.getCreatedAtDate(t.data().createdAt),this.trustedUser=!!t.data().TrustedUser,this.companyWebsite=t.data().website,this.companyDescription=t.data().companyDescription,this.title=this.userName})}),this.getPublishedRoundtrips(t)}},methods:{getPublishedRoundtrips(t){let e=n["b"].collection("Roundtrips").where("UserId","==",t).where("Public","==",!0);e.get().then(e=>{e.empty&&(this.showRoundtrips=!0),e.forEach(t=>{this.publishedRoundtrips+=1,this.createdRoundtrips.push(t.data());let e=[];e.splice(this.createdRoundtrips.findIndex(e=>e.RTId===t.data().RTId),0,t.id);let i=this;var a=n["c"].ref().child("Images/Roundtrips/"+t.id+"/Title/titleImg");a.getDownloadURL().then((function(a){i.TitleImgs.splice(e.indexOf(t.id),0,a)})).catch((function(a){console.log(a),i.TitleImgs.splice(e.indexOf(t.id),0,"../statics/dummy-image-landscape-1-150x150.jpg")})),this.showRoundtrips=!0}),this.getReputation(t)}).catch((function(t){console.log(t),this.showRoundtrips=!0}))},getReputation(t){let e=50*this.publishedRoundtrips,i=25*this.userRTEdited;this.reputation=e+i+100},getLocationString(t){let e="";return t.forEach((t,i)=>{e=e+(0!==i?", ":"")+t}),e},getCreatedAtDate(t){return s["b"].formatDate(new Date(1e3*t.seconds),"DD.MM.YYYY")}}},l=r,c=(i("469f"),i("2877")),d=Object(c["a"])(l,a,o,!1,null,null,null);e["default"]=d.exports},"37e5":function(t,e,i){"use strict";var a=i("f745"),o=i.n(a);o.a},"469f":function(t,e,i){"use strict";var a=i("7cce"),o=i.n(a);o.a},"7cce":function(t,e,i){},"8f40":function(t,e,i){"use strict";var a=i("9264"),o=i.n(a);o.a},9264:function(t,e,i){},e188:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));const a=["Deutschland","Österreich","Schweiz","Luxemburg","Afghanistan","Ägypten","Åland","Albanien","Algerien","Andorra","Argentinien","Armenien","Aruba","Aserbaidschan","Äthiopien","Australien","Bahamas","Bahrain","Bangladesh","Barbados","Belgien","Belize","Benin","Bermuda","Bhutan","Bolivien","Bosnien/Herzegowina","Botsuana","Bouvetinsel","Brasilien","Brunei Darussalam","Bulgarien","Burkina Faso","Burundi","Cabo Verde","Chile","China","Cookinseln","Costa Rica","Cuba","Dominica","Dominikanische Republik","Dschibuti","Dänemark","Ecuador","El Salvador","Elfenbeinküste","Eritrea","Estland","Falklandinseln","Fidschi","Finnland","Frankreich","Französisch-Guayana","Französisch-Polynesien","Französische Südpolarterritorien","Färöer","Gabun","Gambia","Georgien","Ghana","Gibraltar","Grenada","Griechenland","Vereinigtes Königreich","Grönland","Guadeloupe","Guatemala","Guernsey","Guinea-Bissau","Guinea","Guyana","Haiti","Heard und McDonaldinseln","Honduras","Hong Kong","Indien","Indonesien","Irak","Iran","Irland","Island","Isle Of Man","Israel","Italien","Jamaika","Japan","Jemen","Jersey","Jordanien","Jungferninseln, Amerikanische","Jungferninseln, Britische","Kaimaninseln","Kambodscha","Kamerun","Kanada","Kasachstan","Kenia","Kirgisistan","Kiribati","Kokosinseln","Kolumbien","Komoren","Kongo","Kroatien","Kuwait","Laos","Lesotho","Lettland","Libanon","Liberia","Libyen","Liechtenstein","Litauen","Macao","Madagaskar","Malawi","Malaysia","Maldiven","Mali","Malta","Marshallinseln","Martinique","Mauretanien","Mauritius","Mayotte","Mazedonien","Mexiko","Mikronesien","Moldawien","Monaco","Mongolei","Montenegro","Montserrat","Morokko","Mosambik","Myanmar","Namibia","Nauru","Nepal","Neukaledonien","Neuseeland","Nicaragua","Niederlande","Niederländische Antillen","Nigeria","Niger","Niue","Nordkorea","Norfolkinsel","Norwegen","Nördliche Marianen","Oman","Pakistan","Palau","Palestina","Panama","Papua-Neuguinea","Paraguay","Peru","Philippinen","Pitcairninseln","Polen","Portugal","Puerto Rico","Qatar","Ruanda","Rumänien","Russland","Réunion","Salomonen","Sambia","Samoa","San Marino","Saudi-Arabien","Schweden","Senegal","Serbien","Seychellen","Sierra Leone","Simbabwe","Singapur","Slowakische Republik","Slowenien","Somalia","Spanien","Sri Lanka","St. Barthélemy","St. Helena","St. Kitts/Nevis","St. Lucia","St. Martin","St. Pierre/Miquelon","St. Vincent/Die Grenadinen","Sudan","Surinam","Svalbard/Jan Mayen","Swasiland","Syrien","São Tomé/Príncipe","Südafrika","Südgeorgien/Südlichen Sandwichinseln","Südkorea","Tadschikistan","Taiwan","Tansania","Thailand","Timor-Leste","Togo","Tokelau","Tonga","Trinidad und Tobago","Tschad","Tschechien","Tunisien","Turkmenistan","Turks- und Caicosinseln","Tuvalu","Türkei","Uganda","Ukraine","Ungarn","United States Minor Islands","Uruguay","USA","Usbekistan","Vanuatu","Vatikanstadt","Venezuela","Vereinigte Arabische Emirate","Vietnam","Wallis/Futuna","Weihnachtsinsel","Weißrussland","Zentralafrikanische Republik","Zypern"]},f745:function(t,e,i){}}]);